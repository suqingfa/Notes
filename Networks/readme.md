
# 物理层

## 数据通信理论基础
傅里叶变换:任何一个正常的周期为T的函数g(t),都可以展开成多个正弦和余弦函数的和    
![](http://latex.codecogs.com/gif.latex?g(t)=\frac{c}{2}+\sum_{n=1}^{\infty}a_n sin(2\pi nft)+\sum_{n=1}^{\infty}b_n cos(2\pi nft))    
基频 f = 1/T    
计算 an bn c    
![](http://latex.codecogs.com/gif.latex?a_n=\frac{2}{T}\int_{0}^{T}g(t)sin(2\pi nft)dt)   
![](http://latex.codecogs.com/gif.latex?b_n=\frac{2}{T}\int_{0}^{T}g(t)cos(2\pi nft)dt)   
![](http://latex.codecogs.com/gif.latex?c=\frac{2}{T}\int_{0}^{T}g(t)dt)   

### 有限带宽的信号
所有传输设施在传输过程中都要损失能量。如果所有的傅里叶分量都等量地衰减，则结果信号将会在振幅上有所减小，但不会变形。
不幸的是，所有的传输设施对于不同的傅里叶分量的衰减并不相同，因此会导致信号变形。通常情况下，在从0-fc这一段范围内，振幅在传输过程中不会衰减。
传输过程中不会明显衰减的这一段频率范围称为**带宽**。
实践中，截止频率并不会那么明显，所以通常引用的带宽是指从0到某一个能保留一半能量的频率处。

### 信道最大数据传输率
尼奎斯特定理:    
最大传输率 = 2H log_2 V (位/秒)    
H 带宽

热噪声的数量可以用信号功率与噪声的比值来衡量，该比值称为**信噪比**。
信号功率S，噪声功率N，则信噪比S/N。通常情况下使用10 lg S/N，该修值称为分贝。

香农结论    
最大传输率 = H log_2 (1 + S/N)

## 公共交换电话网络 PSTN

### 电话系统结构 
完全互连的网络/中心化的网络/层次化结构    
最终电话系统的三个主要的部分：交换局、顾客与交换局之间的线路、交换局之间的长距离连接。    

端局：本地中心局    
本地回路：用户的电话机与端局之间的连线    
长途局：每个端局都有一个或多个连接着的交换中心，这些交换中心称为长途局。如果它们在同一个局部地区的话，称为汇接局    
长途连接干线：端局与长途局之间的连线

电话系统由三个主要部件构成
- 本地回路 (模拟信号)
- 干线 (数字信号)
- 交换局

多路复用：对于长途干线，主要的问题是如果 将多个呼叫连接收集起来，并且通过同一条光纤将它们发送出去。

### 本地回路 调制解调器 ADSL 无线
调制解调器：当一台计算机希望通过模拟信号线路发送数字数据时，这些数据首先必须转换成模拟信号，才能通过本地回路进行传输。完成这一过程的设备称为调制解调器。    
传输线路存在的三个主要问题：衰减、延迟畸变和噪声。    
衰减是信号在往外传输的过程中能量的损失。这种损失可以表示为每分量多少分贝。能量损失的数量跟频率有关。    
不同的傅里叶分量在线路上的传播速度不同，这种速度的差异会导致接收端信号的畸变。    
噪声是来自非发射器的多余能量。热噪声、串音、脉冲噪声。

#### 调制解调器
AC信号传输。    
首先引用1000-20000Hz内的一个连续波，称为为**正弦载波**。它的振幅、频率或相位被调制后可用来传输信息。
- 调幅
- 调频
- 相位调制

尼奎斯特定理表明，对于理想状态下3000Hz传输线路，采样率超过6000Hz是没有意义的。因此大多数调制解调器采样率为2400Hz，它们的焦点集中在每次采样如何表达更多位信息。    
波特：每秒采样的次数用波特来计量。    
在一个波特中，发送一个码元。在2400波特的线路中，如果码元用0V表示0，1V表示1，则位传输率为2400bps。
然而如果0，1，2，3伏电压都使用的话，每个码元可以包含2位，因此传输速率为4800bps。

#### 数字用户线路 Digital Subscriber Lines
宽带：如果一项服务所提供的带宽比标准的电话服务还要多的话，有时候这样的服务称为宽带。
ADSL 非对称数字线路

调制解调器之所以慢是因为每条本地回路都在端局那里被终止，在这个终止的点上，有一个滤波器把所有300Hz以下3400Hz以上的频率减弱了。    
使用xDSL时，当一名顾客预订了服务时，进来的线路被连接到另一种交换机上，并且这种交换机没有滤波器，因而可以充分发挥本地回路的全部承载能力。

### 干线和多路复用
- 频分多路复用
- 波分多路复用
- 时分多路复用

### 交换
- 电路交换
- 报文交换 
当发送方有一块数据要发送时，它被存储在相一个交换局，然后再转发出去。对数据大小没有限制。交换机必须使用硬盘来缓存大块数据。
- 分组交换
分组交换网络对数据的大小有一个严格的限制，使得这些数据可以被缓存在内存中。分组交换使用存储-转发通信机制。

# 数据链路层 frame
两台相邻机器之间实现可靠有效的通信。
数据链路层要完成的功能：
- 向网络层提供定义良好的服务接口
- 处理传输错误
- 调节数据流，确保慢速的接收方不会被快速的发送发淹没

## 成帧
物理层的任务是接收原始的位流，并试图将它递交给目标机器。这个位流并不保证没有错误。检测错误和纠正错误的工作由数据链路层完成。
对于数据链路层，一般的做法是将位流分解 成离散的帧，并计算第一帧的校验和。

将原始位流分解到离散的帧中
- 字符计数法
利用头部中的一个域来指定该帧中的字符数。计数值可能因为传输错误而被弄乱。

- 含字节填充的分界符法
让每一帧都用一些特殊的字节来作为开始和结束。标志字节。
字节填充：当标志字节出现在数据中时，发送方的数据链路层在这种情况下在标志字节前插入特殊的转义字节。

- 含位填充的分界符法
每个帧的开始和结束都有一个特殊的位模式 01111110。当发送方数据链路层碰到数据中5个连续的位1时，它自动在输出位流中填充一个位0。

- 物理层编码违倒法

## 错误检测和纠正
两种基本的用于错误处理的过程
- 纠错码 在每个被发送的数据中包含足够的冗余信息，以便接收方可以推断出被发送的数据。
- 检错码 在每个被发关的数据中包含一些冗余信息，但这些信息只能让接收方推断出发生了错误。

### 检错码
奇偶位    
CRC 循环冗余校验码

## 基本数据链路层协议
ARQ 自动重传请求协议

## 滑动窗口协议
捎带确认：将确认暂时延迟以便可以钩到一个外发数据帧    
滑动窗口协议    
在任何时刻，发送发总是维持着一组序列号，分别对应于允许它发送的帧。称这些帧落在发送窗口内。     
类似的，接收方也维持着一个接收窗口，对应于一级允许它接受的帧。

1位滑动窗口协议

回退n帧技术的协议
接收到错误帧时，接收方丢弃所有后续帧

选择性重传的协议
接收到坏帧被丢弃，坏帧后续的好帧缓存着。否定确定NAK

## Internet 中的数据链路层

### HDLC 高级数据链路控制

### PPP Point-to-Point Protocol 点到点协议
PPP 提供了三类功能
- 成帧方法
- 链路控制协议。可用于启动线路、测试线路、协商参数，以及当线路不再需要的时候可以温和地关闭线路。LCP(Link Control Protocol)
- 协商网络层选项的方法。NCP(Network Control Protocol)
''
